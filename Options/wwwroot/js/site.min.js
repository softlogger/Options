function loadInitial(){loadHeader();bindEvents();loadHistoricalLowPrices();loadCallOption();loadPutOption();loadStatementTable();loadToolTips();var n=colNumberForCallCalculations();setBuyingPrice(n);setCashFlowMultiple(n);setDividendAmount();SetRateOfReturn();setMaxRateOfReturn();setLossRate()}function loadCallOption(){loadExpDates();loadStrikes();loadOptionQuotes()}function loadPutOption(){loadPutExpDates();loadPutStrikes();loadPutOptionQuotes()}function loadHeader(){var u=jsonQuoteObject.shortName,t=jsonQuoteObject.bid,i=jsonQuoteObject.ask,r=jsonQuoteObject.regularMarketPrice,n=jsonQuoteObject.postMarketPrice;typeof n=="number"&&(n=Number(n).toFixed(2));var f="<h5><strong>"+u+"<\/strong><\/h5>",e="Last Close:<strong> "+n+"<\/strong>",o="Regular:<strong> "+r+"<\/strong>",s="Bid:<strong> "+t+"<\/strong>",h="Ask:<strong> "+i+"<\/strong>",c="<a href="+decodeURIComponent(ReportUrl)+" target=_blank type=button class='btn btn-info'>10-K<\/a>",l=f+" "+e+" "+o+" "+s+" "+h+" "+c;$("#headerId").html(l);$("#regPriceId").val(r);$("#previousClosePriceId").val(n);$("#bidId").val(t);$("#askId").val(i);$("#lastPriceId").val(n)}function SetReturns(){setLossRate();SetRateOfReturn();setMaxRateOfReturn()}function getAverageSharePrice(){var r=Number($("#bidId").val()),u=Number($("#askId").val()),i=(r+u)/2,n,t;return!Number.isNaN(i)&&Number>0?i:(n=Number($("#regPriceId").val()),!(Number.isNaN(n)&&n>0))?n:(t=Number($("#lastPriceId").val()),(Number.isNaN(t)&&t>0)?void 0:t)}function getAverageCallPremium(){var n=Number($("#quoteTableId #optionBid").text()),t=Number($("#quoteTableId #optionAsk").text());return(n+t)/2}function colNumberForCallCalculations(){return numOfCols()-Number(numOfYearsProjected)}function setLossRate(){var t=getAverageSharePrice(),r=colNumberForCallCalculations(),i=Number($("#statementTableId #Buying_Price"+r).text().replace(/,/g,"")),n=Number($("#dividendTableId #divTotalId").text().replace(/,/g,""));Number.isNaN(n)&&(n=Number(0));var u=(t-(i-n))/t,f=(u*100).toFixed(2),e="At expiration Stock must have fallen below this rate to lose money on this transaction\nStock Price: "+t+" Buying Price: "+i+" Dividends: "+n;$("#lossRateId").text(f+" %");$("#lossRateId").attr("title",e)}function SetRateOfReturn(){var t=getAverageSharePrice(),i=getAverageCallPremium(),n=Number($("#dividendTableId #divTotalId").text());isNaN(n)&&(n=Number(0));var u=i+n,f=$("#expDateId").find(":selected").val(),e=Epoch(new Date),o=f-e,r=o/86400+1,s=(u/t*(365/r)*100).toFixed(2),h="This is the annualized rate of return at expiration if the Calls expire worthless\nStock Price: "+t+" Call Premium: "+i+" Dividends: "+n+" Number of Days: "+Math.floor(r);$("#rorId").attr("title",h);$("#rorId").text(s+" %")}function setMaxRateOfReturn(){var t=getAverageSharePrice(),u=Number($("#strikeId").val()),i=Math.abs(t-u),r,n;u<t&&(i=-i);r=getAverageCallPremium();n=Number($("#dividendTableId #divTotalId").text());isNaN(n)&&(n=Number(0));var e=r+n+i,o=$("#expDateId").find(":selected").val(),s=Epoch(new Date),h=o-s,f=h/86400+1,c=(e/t*(365/f)*100).toFixed(2),l="This is the maximum annualized rate of return at expiration if the Stock is trading above strike price and called(sold)\nStock Price: "+t+" Call Premium: "+r+" Dividends: "+n+" Diff in Strike and Stock Price: "+i.toFixed(2)+" Number of Days: "+Math.floor(f);$("#maxRateId").attr("title",l);$("#maxRateId").text(c+" %")}function setDividendAmount(){var r=jsonDividendString.HasValue;if(r===!0){var n=jsonDividendString.Date,t=jsonDividendString.Value,i=getNumberOfNinetyDayPeriods(n),u=(t*i).toFixed(2);$("#dividendTableId #divExDateId").text(n);$("#dividendTableId #divAmountId").text(t);$("#dividendTableId #divPeriodId").text(i);$("#dividendTableId #divTotalId").text(u)}else $("#dividendTableId #divExDateId").text("N/A"),$("#dividendTableId #divAmountId").text("N/A"),$("#dividendTableId #divPeriodId").text("N/A"),$("#dividendTableId #divTotalId").text("N/A")}function getNumberOfNinetyDayPeriods(n){var n=new Date(n),i=Epoch(n),r=Number($("#expDateId").find(":selected").val()),t=(r-i)/86400+1;return t<90?0:Math.floor(t/90)}function bindEvents(){$("#resetId").on("click",Reset);$("#recalculateId").on("click",Recalculate);$("#expDateId").on("change",expirationChanged);$("#strikeId").on("change",strikesChanged);$("#putExpDateId").on("change",putExpirationChanged);$("#putStrikeId").on("change",putStrikesChanged)}function loadHistoricalLowPrices(){var n;$("#historicalPricessId").empty();$("#historicalPricessId").append("<thead><tr><\/thead><\/tr>");$("#historicalPricessId").append("<tbody><tr><\/tbody><\/tr>");for(n in historicalPrices)if(historicalPrices.hasOwnProperty(n)){var i=historicalPrices[n],t=i.split(" "),r=t[1],u=Number(t[0]),f=new Date(r),e=f.getMonth(),o=months(Number(e));$("#historicalPricessId > thead > tr").append("<th>"+o+" "+n+"<\/th>");$("#historicalPricessId > tbody > tr").append("<td>"+u.toFixed(2)+"<\/td>")}}function loadExpDates(){var i="#expDateId",n,t;for($(i).empty(),n=0;n<jsonDates.length;n++)$(i).append("<option value='"+jsonDates[n]+"'>"+EpochToDate(jsonDates[n])+"<\/option>");t=jsonDates[jsonDates.length-1];console.log(t);$("#expDateId option[value="+t+"]").prop("selected","selected")}function loadPutExpDates(){var i="#putExpDateId",n,t;for($(i).empty(),n=0;n<jsonDates.length;n++)$(i).append("<option value='"+jsonDates[n]+"'>"+EpochToDate(jsonDates[n])+"<\/option>");t=jsonDates[jsonDates.length-1];console.log(t);$("#putExpDateId option[value="+t+"]").prop("selected","selected")}function expirationChanged(){loadStrikes();loadOptionQuotes();callPremiumChanged();setDividendAmount();SetReturns()}function strikesChanged(){loadOptionQuotes();callPremiumChanged();setDividendAmount();SetReturns()}function putExpirationChanged(){loadPutStrikes();loadPutOptionQuotes()}function putStrikesChanged(){loadPutOptionQuotes()}function loadStrikes(){var r="#strikeId",f=$("#expDateId").find(":selected").val(),t=jsonStrikes[f],u,i,n;for($(r).empty(),u=getAverageSharePrice(),n=0;n<t.length;n++)$(r).append("<option value='"+t[n]+"'>"+t[n]+"<\/option>");for(i=0,n=0;n<t.length;n++)if(t[n]>u){i=t[n];break}i==0?$("#strikeId").val(t[t.length-1]):$("#strikeId").val(i)}function loadPutStrikes(){var r="#putStrikeId",f=$("#putExpDateId").find(":selected").val(),t=jsonStrikes[f],u,i,n;for($(r).empty(),u=getAverageSharePrice(),n=0;n<t.length;n++)$(r).append("<option value='"+t[n]+"'>"+t[n]+"<\/option>");for(i=0,n=0;n<t.length;n++)if(t[n]>u){i=t[n];break}i==0?$("#putStrikeId").val(t[t.length-1]):$("#putStrikeId").val(i)}function loadOptionQuotes(){var t;console.log("in option quotes");var i=$("#expDateId").val(),r=jsonContainer[i],u=$("#strikeId").val(),n=r[u];$("#quoteTableId").empty();$("#quoteTableId").append("<thead><tr><\/thead><\/tr>");$("#quoteTableId").append("<tbody><tr><\/tbody><\/tr>");$("#quoteTableId > thead > tr").append("<th>Last Price<\/th>");$("#quoteTableId > thead > tr").append("<th>Bid<\/th>");$("#quoteTableId > thead > tr").append("<th>Ask<\/th>");$("#quoteTableId > thead > tr").append("<th>Imp Volatility<\/th>");$("#quoteTableId > tbody > tr").append("<td>"+n.lastPrice+"<\/td>");$("#quoteTableId > tbody > tr").append("<td id='optionBid'>"+n.bid+"<\/td>");$("#quoteTableId > tbody > tr").append("<td id='optionAsk'>"+n.ask+"<\/td>");t=(Number(n.impliedVolatility)*100).toFixed(2)+"%";$("#quoteTableId > tbody > tr").append("<td>"+t+"<\/td>")}function loadPutOptionQuotes(){var t;console.log("in option quotes");var i=$("#putExpDateId").val(),r=jsonPutContainer[i],u=$("#putStrikeId").val(),n=r[u];$("#putQuoteTableId").empty();$("#putQuoteTableId").append("<thead><tr><\/thead><\/tr>");$("#putQuoteTableId").append("<tbody><tr><\/tbody><\/tr>");$("#putQuoteTableId > thead > tr").append("<th>Last Price<\/th>");$("#putQuoteTableId > thead > tr").append("<th>Bid<\/th>");$("#putQuoteTableId > thead > tr").append("<th>Ask<\/th>");$("#putQuoteTableId > thead > tr").append("<th>Imp Volatility<\/th>");$("#putQuoteTableId > tbody > tr").append("<td>"+n.lastPrice+"<\/td>");$("#putQuoteTableId > tbody > tr").append("<td id='optionBid'>"+n.bid+"<\/td>");$("#putQuoteTableId > tbody > tr").append("<td id='optionAsk'>"+n.ask+"<\/td>");t=(Number(n.impliedVolatility)*100).toFixed(2)+"%";$("#putQuoteTableId > tbody > tr").append("<td>"+t+"<\/td>")}function loadStatementTable(){var u=JsonStatementTable[JsonStatementTable.length-1],s=u.length-2,i,e,r,t,n;for($("#statementTableId").empty(),$("#statementTableId").append("<thead><\/thead>"),$("#statementTableId").append("<tbody><\/tbody>"),$("#statementTableId > thead").append("<tr><\/tr>"),i=0;i<u.length;i++)e=u[i],$("#statementTableId > thead > tr:last").append("<th>"+e+"<\/th>");for(r=1;r<JsonStatementTable.length-1;r++)for($("#statementTableId > tbody").append("<tr><\/tr>"),t=JsonStatementTable[r],n=0;n<t.length;n++){var h=t[0]+n,f=t[n],c=t[0],o=FormattedValue(f);if($("#statementTableId tr:last").append("<td id="+h+" data-val="+o+">"+o+"<\/td>"),f=="Buying_Price"&&$("#statementTableId  tr:last").attr("title",buyingPriceFormula()),f=="Cash_Flow_Multiple"&&$("#statementTableId  tr:last").attr("title",cashFlowFormula()),n===s&&c==="Buying_Price"){var l=getAverageSharePrice(),a=getAverageCallPremium(),v="Buying Price: "+l+" less Call Premium:  "+a+"\nCall Premium is average of bid and ask. Share price is either -  average of Bid and Ask or Regular Price or Last Price based on available data";$("#statementTableId  tr:last td:last").prop("title",v)}}}function GetNextYearFor(n){var t=new Date(n),i=new Date(t.getFullYear()+1,t.getMonth(),t.getDate());return i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate()}function getProjectedValuefor(n){var i=n.length,r=Number(n[1]),t=Number(n[i-1]),u;return r===t?1:(u=CalculateGrowthRate(r,t,i-1),t+u*t)}function getInitialEbitdaId(){return"#Ebitda1"}function getFinalEbitdaId(){var n=numOfCols();return n>1?"#Ebitda"+(n-1).toString():"#Ebitda1"}function setEbitdaGrowthRate(){var n=calculateEbitdaGrowthRate();$("#projectedEbitdaGrowthId").val((n*100).toFixed(2))}function setprojectedEbitda(){var i=$("#statementTableId "+getFinalEbitdaId()),r=Number($(i).text().replace(/,/g,"")),n=$("#projectedEbitdaGrowthId").val(),t;n=Number(n/100);t=r*(1+n);$("#projectedEbitdaId").val(FormattedValue(t.toFixed(0)))}function setBuyingPrice(n){var t="#statementTableId #Buying_Price"+n;$(t).text(BuyingPrice())}function setCashFlowMultiple(n){var t="#statementTableId #Cash_Flow_Multiple"+n;$(t).text(CashFlowMultiple(n))}function loadToolTips(){var t=buyingPriceFormula(),i=cashFlowFormula(),n;$("#buyingPriceFormulaId").prop("title",t);$("#cashFlowFormulaId").prop("title",i);$("#growthRateId").prop("title","((final/initial) raised to (1 / num of periods)) - 1) .. Note - num of periods = 3");$("#projectedEbitdaFormulaId").prop("title","Displayed growth rate times last reported Ebitda");$("#projectedNumOfSharesFormulaId").prop("title","Calculate growth rate per year over year changes in shares count and multiply that growth rate times last reported shares count");n=getBuyingPriceTitleString();$("#statementTableId #Buying_Price0").prop("title",n)}function EpoctoLocaleString(n){var n=new Date(n*1e3);return n.toLocaleString()}function getBuyingPriceTitleString(){var t="",n,i;for(n in historicalPrices)historicalPrices.hasOwnProperty(n)&&(i="Year: "+n+" Low price and Date: "+historicalPrices[n]+"\n",t+=i);return t}function Reset(){for(var n=colNumberForCallCalculations(),t=1;t<10;t++){var r="#statementTableId tr:eq("+t+") td:eq("+n+")",i=$(r),u=i.attr("data-val");i.text(u)}setBuyingPrice(n);setCashFlowMultiple(n);setDividendAmount();SetRateOfReturn()}function FormattedValue(n){return typeof Number(n)=="number"&&isFinite(n)?Number(n).toLocaleString():n}function numOfCols(){return $("#statementTableId").find("tr")[0].cells.length}function SharePrice(){var n=Number($("#askId").val()),t=Number($("#lastPriceId").val());return n===0?t:n}function TotalLblMinusCurrentAssets(){var n=(numOfCols()-2).toString(),t="#statementTableId #Total_Liabilities"+n,i=Number($(t).text().replace(/,/g,"")),r="#statementTableId #Current_Assets"+n,u=Number($(r).text().replace(/,/g,""));return(i-u).toLocaleString()}function BuyingPrice(){var n=getAverageSharePrice(),t=getAverageCallPremium(),i=n-t;return i.toFixed(2)}function CashFlowMultiple(n){var i=Number($("#statementTableId #Buying_Price"+n).text().replace(/,/g,"")),r=Number($("#statementTableId #Ebitda"+n).text().replace(/,/g,"")),t=Number($("#statementTableId #Weighted_Avg_Diluted_Shares"+n).text().replace(/,/g,"")),u=Number($("#statementTableId #Total_Lbs_Minus_Assets"+n).text().replace(/,/g,"")),f=u/t,e=(i+f)/(r/t);return e.toFixed(3)}function searchTicker(){var n,i,t;console.log("In search ticker");n=$("#ticker").val();console.log(n);console.log(window.location.origin);console.log(window.location.href);i=window.location.href.includes("Home");t="";t=i===!0?"Analysis?tickerName="+n:"Home/Analysis?tickerName="+n;window.location.href=t}function Epoch(n){return Math.round(new Date(n).getTime()/1e3)}function EpochToDate(n){var t=new Date(n*1e3),i=t.getUTCDate(),r=t.getUTCMonth(),u=t.getUTCFullYear(),f=months(r);return f+" "+i+", "+u}function months(n){return["January","February","March","April","May","June","July","August","September","October","November","December"][n]}function UpdateStrikes(){var i=$("#expDateId").val(),n,t;for(alert(i),n=strks[i],console.log(n),$("#strikeId").empty(),t=0;t<n.length;t++)$("#strikeId").append("<option value='"+n[t]+"'>"+n[t]+"<\/option>")}function EbitdaChanged(){$("#projectedEbitdaCheckId").is(":checked")&&$("#projectedEbitdaGrowthCheckId").prop("checked",!1)}function GrowthChanged(){$("#projectedEbitdaGrowthCheckId").is(":checked")&&$("#projectedEbitdaCheckId").prop("checked",!1)}function buyingPriceFormula(){return"Stock Price - Call Premium"}function cashFlowFormula(){return"(Buying Price + (Current Assets - Minus Liab / Proj Num of Shares)) / (Projected EBITDA/Proj Num of Shares)"}function callPremiumChanged(){var n=colNumberForCallCalculations();setBuyingPrice(n);setCashFlowMultiple(n)}function Recalculate(){var n=colNumberForCallCalculations();setTotalLibMinusCurrentAssets();setCashFlowMultiple(n);SetRateOfReturn()}function setTotalLibMinusCurrentAssets(){var n=colNumberForCallCalculations(),t=TotalLblMinusCurrentAssets();$("#statementTableId #Total_Lbs_Minus_Assets"+n).text(t)}function backup(){$("#ticker").focus();$("#strike").on("change",function(){var n=$(this).find(":selected").val();alert(n)});$("#finalDate").on("change",function(n){n.preventDefault();alert($(this).find(":selected").val());alert($(this).find(":selected").text())});$(".theButton").on("click",function(){alert(dates);alert("wtf");var n=$("#finalDate").find(":selected").text();alert(n)});$(document).bind("keypress",function(n){n.keyCode==13&&$("#searchButton").trigger("click")});$("#searchButton").on("click",function(){var n=$("#ticker").val();$.get("Home/ExpVC",{tickerName:n},function(n){$("#expirationWidget").html(n)})})}$(document).ready(function(){$("#ticker").focus();$(document).bind("keypress",function(n){n.keyCode===13&&$("#searchTickerBtn").trigger("click")});loadInitial()});