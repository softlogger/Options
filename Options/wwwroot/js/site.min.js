function loadInitial(){loadHeader();bindEvents();loadHistoricalLowPrices();loadExpDates();loadStrikes();loadOptionQuotes();loadStatementTable();loadToolTips();var n=(numOfCols()-2).toString();setBuyingPrice(n);setCashFlowMultiple(n);setDividendAmount();SetRateOfReturn();setMaxRateOfReturn();setLossRate()}function loadHeader(){var u=jsonQuoteObject.shortName,t=jsonQuoteObject.bid,i=jsonQuoteObject.ask,r=jsonQuoteObject.regularMarketPreviousClose,n=jsonQuoteObject.postMarketPrice;typeof n=="number"&&(n=Number(n).toFixed(2));var f="<h4><strong>"+u+"<\/strong><h4>",e="Last Close:<strong> "+n+"<\/strong>",o="Regular:<strong> "+r+"<\/strong>",s="Bid:<strong> "+t+"<\/strong>",h="Ask:<strong> "+i+"<\/strong>",c="<a href="+decodeURIComponent(ReportUrl)+" target=_blank type=button class='btn btn-info'>10-K<\/a>",l=f+" "+e+" "+o+" "+s+" "+h+" "+c;$("#headerId").html(l);$("#regPriceId").val(r);$("#previousClosePriceId").val(n);$("#bidId").val(t);$("#askId").val(i);$("#lastPriceId").val(n)}function SetReturns(){setLossRate();SetRateOfReturn();setMaxRateOfReturn()}function setLossRate(){var t=Number(SharePrice()),r=(numOfCols()-2).toString(),i=Number($("#statementTableId #Buying_Price"+r).text().replace(/,/g,"")),n=Number($("#dividendTableId #divTotalId").text().replace(/,/g,""));Number.isNaN(n)&&(n=Number(0));var u=(t-(i+n))/t,f=(u*100).toFixed(2),e="At expiration Stock must have fallen below this rate to lose money on this transaction\nStock Price: "+t+" Buying Price: "+i+" Dividends: "+n;$("#lossRateId").text(f+" %");$("#lossRateId").attr("title",e)}function SetRateOfReturn(){var t=Number(SharePrice()),i=Number($("#optionBid").text()),n=Number($("#dividendTableId #divTotalId").text());isNaN(n)&&(n=Number(0));var u=i+n,f=$("#expDateId").find(":selected").val(),e=Epoch(new Date),o=f-e,r=o/86400+1,s=(u/t*(365/r)*100).toFixed(2),h="This is the annualized rate of return at expiration if the Calls expire worthless\nStock Price: "+t+" Call Premium: "+i+" Dividends: "+n+" Number of Days: "+Math.floor(r);$("#rorId").attr("title",h);$("#rorId").text(s+" %")}function setMaxRateOfReturn(){var t=Number(SharePrice()),u=Number($("#strikeId").val()),i=Math.abs(t-u),r,n;u<t&&(i=-i);r=Number($("#optionBid").text());n=Number($("#dividendTableId #divTotalId").text());isNaN(n)&&(n=Number(0));var e=r+n+i,o=$("#expDateId").find(":selected").val(),s=Epoch(new Date),h=o-s,f=h/86400+1,c=(e/t*(365/f)*100).toFixed(2),l="This is the maximum annualized rate of return at expiration if the Stock is trading above strike price and called(sold)\nStock Price: "+t+" Call Premium: "+r+" Dividends: "+n+" Diff in Strike and Stock Price: "+i.toFixed(2)+" Number of Days: "+Math.floor(f);$("#maxRateId").attr("title",l);$("#maxRateId").text(c+" %")}function setDividendAmount(){var r=jsonDividendString.HasValue;if(r===!0){var n=jsonDividendString.Date,t=jsonDividendString.Value,i=getNumberOfNinetyDayPeriods(n),u=(t*i).toFixed(2);$("#dividendTableId #divExDateId").text(n);$("#dividendTableId #divAmountId").text(t);$("#dividendTableId #divPeriodId").text(i);$("#dividendTableId #divTotalId").text(u)}else $("#dividendTableId #divExDateId").text("N/A"),$("#dividendTableId #divAmountId").text("N/A"),$("#dividendTableId #divPeriodId").text("N/A"),$("#dividendTableId #divTotalId").text("N/A")}function getNumberOfNinetyDayPeriods(n){var n=new Date(n),i=Epoch(n),r=Number($("#expDateId").find(":selected").val()),t=(r-i)/86400+1;return t<90?0:Math.floor(t/90)}function bindEvents(){$("#resetId").on("click",Reset);$("#recalculateId").on("click",Recalculate);$("#expDateId").on("change",expirationChanged);$("#strikeId").on("change",strikesChanged)}function loadHistoricalLowPrices(){var n;$("#historicalPricessId").empty();$("#historicalPricessId").append("<thead><tr><\/thead><\/tr>");$("#historicalPricessId").append("<tbody><tr><\/tbody><\/tr>");for(n in historicalPrices)if(historicalPrices.hasOwnProperty(n)){var i=historicalPrices[n],t=i.split(" "),r=t[1],u=Number(t[0]),f=new Date(r),e=f.getMonth(),o=months(Number(e));$("#historicalPricessId > thead > tr").append("<th>"+o+" "+n+"<\/th>");$("#historicalPricessId > tbody > tr").append("<td>"+u.toFixed(2)+"<\/td>")}}function loadExpDates(){var i="#expDateId",n,t;for($(i).empty(),n=0;n<jsonDates.length;n++)$(i).append("<option value='"+jsonDates[n]+"'>"+EpochToDate(jsonDates[n])+"<\/option>");t=jsonDates[jsonDates.length-1];console.log(t);$("#expDateId option[value="+t+"]").prop("selected","selected")}function expirationChanged(){loadStrikes();loadOptionQuotes();callPremiumChanged();setDividendAmount();SetReturns()}function strikesChanged(){loadOptionQuotes();callPremiumChanged();setDividendAmount();SetReturns()}function loadStrikes(){var r="#strikeId",f=$("#expDateId").find(":selected").val(),t=jsonStrikes[f],u,i,n;for($(r).empty(),u=SharePrice(),n=0;n<t.length;n++)$(r).append("<option value='"+t[n]+"'>"+t[n]+"<\/option>");for(i=0,n=0;n<t.length;n++)if(t[n]>u){i=t[n];break}i==0?$("#strikeId").val(t[t.length-1]):$("#strikeId").val(i)}function loadOptionQuotes(){var t;console.log("in option quotes");var i=$("#expDateId").val(),r=jsonContainer[i],u=$("#strikeId").val(),n=r[u];$("#quoteTableId").empty();$("#quoteTableId").append("<thead><tr><\/thead><\/tr>");$("#quoteTableId").append("<tbody><tr><\/tbody><\/tr>");$("#quoteTableId > thead > tr").append("<th>Last Trade<\/th>");$("#quoteTableId > thead > tr").append("<th>Last Price<\/th>");$("#quoteTableId > thead > tr").append("<th>Bid<\/th>");$("#quoteTableId > thead > tr").append("<th>Ask<\/th>");$("#quoteTableId > thead > tr").append("<th>Change<\/th>");$("#quoteTableId > thead > tr").append("<th>% Change<\/th>");$("#quoteTableId > thead > tr").append("<th>Volume<\/th>");$("#quoteTableId > thead > tr").append("<th>Open Int<\/th>");$("#quoteTableId > thead > tr").append("<th>Imp Volatility<\/th>");$("#quoteTableId > tbody > tr").append("<td>"+EpoctoLocaleString(n.lastTradeDate)+"<\/td>");$("#quoteTableId > tbody > tr").append("<td>"+n.lastPrice+"<\/td>");$("#quoteTableId > tbody > tr").append("<td id='optionBid'>"+n.bid+"<\/td>");$("#quoteTableId > tbody > tr").append("<td>"+n.ask+"<\/td>");$("#quoteTableId > tbody > tr").append("<td>"+Number(n.change).toFixed(2)+"<\/td>");$("#quoteTableId > tbody > tr").append("<td>"+Number(n.percentChange).toFixed(2)+"%<\/td>");$("#quoteTableId > tbody > tr").append("<td>"+n.volume+"<\/td>");$("#quoteTableId > tbody > tr").append("<td>"+n.openInterest+"<\/td>");t=(Number(n.impliedVolatility)*100).toFixed(2)+"%";$("#quoteTableId > tbody > tr").append("<td>"+t+"<\/td>")}function loadStatementTable(){var f=JsonStatementTable[JsonStatementTable.length-1],t,e,i,r,n;for($("#statementTableId").empty(),$("#statementTableId").append("<thead><\/thead>"),$("#statementTableId").append("<tbody><\/tbody>"),$("#statementTableId > thead").append("<tr><\/tr>"),t=0;t<f.length;t++)e=f[t],$("#statementTableId > thead > tr:last").append("<th>"+e+"<\/th>");for(i=1;i<JsonStatementTable.length-1;i++)for($("#statementTableId > tbody").append("<tr><\/tr>"),r=JsonStatementTable[i],n=0;n<r.length;n++){var s=r[0]+n,u=r[n],o=FormattedValue(u);$("#statementTableId tr:last").append("<td id="+s+" data-val="+o+">"+o+"<\/td>");u=="Buying_Price"&&$("#statementTableId  tr:last").attr("title",buyingPriceFormula());u=="Cash_Flow_Multiple"&&$("#statementTableId  tr:last").attr("title",cashFlowFormula())}$("#statementTableId td:nth-child(5)").attr("contenteditable","true")}function GetNextYearFor(n){var t=new Date(n),i=new Date(t.getFullYear()+1,t.getMonth(),t.getDate());return i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate()}function getProjectedValuefor(n){var i=n.length,r=Number(n[1]),t=Number(n[i-1]),u;return r===t?1:(u=CalculateGrowthRate(r,t,i-1),t+u*t)}function calculateEbitdaGrowthRate(){var n=numOfCols(),f=getInitialEbitdaId(),t=getFinalEbitdaId(),i="#statementTableId "+t,r=Number($(i).text().replace(/,/g,"")),u=Number($("#statementTableId #Ebitda1").text().replace(/,/g,""));return CalculateGrowthRate(u,r,n-1)}function getInitialEbitdaId(){return"#Ebitda1"}function getFinalEbitdaId(){var n=numOfCols();return n>1?"#Ebitda"+(n-1).toString():"#Ebitda1"}function setEbitdaGrowthRate(){var n=calculateEbitdaGrowthRate();$("#projectedEbitdaGrowthId").val((n*100).toFixed(2))}function setprojectedEbitda(){var i=$("#statementTableId "+getFinalEbitdaId()),r=Number($(i).text().replace(/,/g,"")),n=$("#projectedEbitdaGrowthId").val(),t;n=Number(n/100);t=r*(1+n);$("#projectedEbitdaId").val(FormattedValue(t.toFixed(0)))}function setProjectedNumberOfShares(){var t=numOfCols(),n="#statementTableId #Weighted_Avg_Diluted_Shares";n=t>1?n+(t-1).toString():n+1..toString();var i=Number($(n).text().replace(/,/g,"")),r=Number($("#statementTableId #Weighted_Avg_Diluted_Shares1").text().replace(/,/g,"")),u=CalculateGrowthRate(r,i,t-1),f=i*(1+u);$("#projectedNumOfSharesId").val(FormattedValue(f.toFixed(0)))}function setSharePrice(){$("#sharePriceId").val(SharePrice())}function setCallPremium(){$("#callPremiumId").val($("#optionBid").text())}function setBuyingPrice(n){var t="#statementTableId #Buying_Price"+n;$(t).text(BuyingPrice())}function setCashFlowMultiple(n){var t="#statementTableId #Cash_Flow_Multiple"+n;$(t).text(CashFlowMultiple(n))}function loadToolTips(){var n=buyingPriceFormula(),t=cashFlowFormula();$("#buyingPriceFormulaId").prop("title",n);$("#cashFlowFormulaId").prop("title",t);$("#growthRateId").prop("title","((final/initial) raised to (1 / num of periods)) - 1) .. Note - num of periods = 3");$("#projectedEbitdaFormulaId").prop("title","Displayed growth rate times last reported Ebitda");$("#projectedNumOfSharesFormulaId").prop("title","Calculate growth rate per year over year changes in shares count and multiply that growth rate times last reported shares count")}function EpoctoLocaleString(n){var n=new Date(n*1e3);return n.toLocaleString()}function Reset(){for(var n=(numOfCols()-2).toString(),t=1;t<10;t++){var r="#statementTableId tr:eq("+t+") td:eq("+n+")",i=$(r),u=i.attr("data-val");i.text(u)}setBuyingPrice(n);setCashFlowMultiple(n);SetRateOfReturn();setDividendAmount()}function Unfreeze(){$("#projectedEbitdaGrowthCheckId").prop("checked",!1);$("#projectedEbitdaCheckId").prop("checked",!1);$("#projectedNumOfSharesCheckId").prop("checked",!1);$("#sharePriceCheckId").prop("checked",!1);$("#callPremiumCheckId").prop("checked",!1);$("#lblMinusCurrAssCheckId").prop("checked",!1)}function FormattedValue(n){return typeof Number(n)=="number"&&isFinite(n)?Number(n).toLocaleString():n}function numOfCols(){return $("#statementTableId").find("tr")[0].cells.length}function CalculateGrowthRate(n,t,i){if(n<0||t<0)return.1;var r=1/i,u=t/n;return Math.pow(u,r)-1}function SharePrice(){var n=Number($("#askId").val()),t=Number($("#lastPriceId").val());return n===0?t:n}function TotalLblMinusCurrentAssets(){var n=(numOfCols()-2).toString(),t="#statementTableId #Total_Liabilities"+n,i=Number($(t).text().replace(/,/g,"")),r="#statementTableId #Current_Assets"+n,u=Number($(r).text().replace(/,/g,""));return(i-u).toLocaleString()}function BuyingPrice(){var n=SharePrice(),t=Number($("#optionBid").text()),i=n-t;return i.toFixed(2)}function CashFlowMultiple(n){var i=Number($("#statementTableId #Buying_Price"+n).text().replace(/,/g,"")),r=Number($("#statementTableId #Ebitda"+n).text().replace(/,/g,"")),t=Number($("#statementTableId #Weighted_Avg_Diluted_Shares"+n).text().replace(/,/g,"")),u=Number($("#statementTableId #Total_Lbs_Minus_Assets"+n).text().replace(/,/g,"")),f=u/t,e=(i+f)/(r/t);return e.toFixed(3)}function searchTicker(){var n,i,t;console.log("In search ticker");n=$("#ticker").val();console.log(n);console.log(window.location.origin);console.log(window.location.href);i=window.location.href.includes("Home");t="";t=i===!0?"Analysis?tickerName="+n:"Home/Analysis?tickerName="+n;window.location.href=t}function Epoch(n){return Math.round(new Date(n).getTime()/1e3)}function EpochToDate(n){var t=new Date(n*1e3),i=t.getUTCDate(),r=t.getUTCMonth(),u=t.getUTCFullYear(),f=months(r);return f+" "+i+", "+u}function months(n){return["January","February","March","April","May","June","July","August","September","October","November","December"][n]}function UpdateStrikes(){var i=$("#expDateId").val(),n,t;for(alert(i),n=strks[i],console.log(n),$("#strikeId").empty(),t=0;t<n.length;t++)$("#strikeId").append("<option value='"+n[t]+"'>"+n[t]+"<\/option>")}function EbitdaChanged(){$("#projectedEbitdaCheckId").is(":checked")&&$("#projectedEbitdaGrowthCheckId").prop("checked",!1)}function GrowthChanged(){$("#projectedEbitdaGrowthCheckId").is(":checked")&&$("#projectedEbitdaCheckId").prop("checked",!1)}function buyingPriceFormula(){return"Stock Price - Call Premium"}function cashFlowFormula(){return"(Buying Price - (Current Assets - Minus Liab / Proj Num of Shares)) / (Projected EBITDA/Proj Num of Shares)"}function callPremiumChanged(){var n=(numOfCols()-2).toString();setCallPremium();setBuyingPrice(n);setCashFlowMultiple(n)}function Recalculate(){var n=(numOfCols()-2).toString();setTotalLibMinusCurrentAssets();setBuyingPrice(n);setCashFlowMultiple(n);SetRateOfReturn();setDividendAmount()}function setTotalLibMinusCurrentAssets(){var n=(numOfCols()-2).toString(),t=TotalLblMinusCurrentAssets();$("#statementTableId #Total_Lbs_Minus_Assets"+n).text(t)}function backup(){$("#ticker").focus();$("#strike").on("change",function(){var n=$(this).find(":selected").val();alert(n)});$("#finalDate").on("change",function(n){n.preventDefault();alert($(this).find(":selected").val());alert($(this).find(":selected").text())});$(".theButton").on("click",function(){alert(dates);alert("wtf");var n=$("#finalDate").find(":selected").text();alert(n)});$(document).bind("keypress",function(n){n.keyCode==13&&$("#searchButton").trigger("click")});$("#searchButton").on("click",function(){var n=$("#ticker").val();$.get("Home/ExpVC",{tickerName:n},function(n){$("#expirationWidget").html(n)})})}$(document).ready(function(){$("#ticker").focus();$(document).bind("keypress",function(n){n.keyCode===13&&$("#searchTickerBtn").trigger("click")});loadInitial()});